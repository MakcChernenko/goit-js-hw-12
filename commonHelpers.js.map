{"version":3,"file":"commonHelpers.js","sources":["../src/js/helpers.js","../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport const refs = {\n  form: document.querySelector('#request-form'),\n  gallery: document.querySelector('.gallery'),\n  loadBtn: document.querySelector('.load-btn'),\n};\n\nconst MESSAGES = {\n  info: `Please enter a value in the search field!`,\n  endOfSearch: `We're sorry, but you've reached the end of search results.`,\n  warning: `Sorry, there are no images matching your search query. Please try again!`,\n  error: `Sorry, there are no connection to the server. Please try again later!`,\n  exception: `Exception: We have some issue with connection. Please try again later!`,\n};\n\nconst MESSAGES_BG_COLORS = {\n  blue: '#abd4f8',\n  orange: '#f28111',\n  red: '#e97782',\n};\n\nconst EVENT_TYPE = {\n  click: 'click',\n  submit: 'submit',\n};\n\nfunction showInfoMessage(message, color) {\n  iziToast.info({\n    position: 'topRight',\n    backgroundColor: `${color}`,\n    message: `${message}`,\n  });\n}\n\nexport { EVENT_TYPE, MESSAGES, MESSAGES_BG_COLORS, showInfoMessage };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './helpers';\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst { gallery } = refs;\n\nexport function fetchGallery(data) {\n  gallery.insertAdjacentHTML('beforeend', markupGallery(data));\n\n  lightbox.refresh();\n}\n\nfunction markupGallery(data) {\n  return data.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li>\n                <a href=\"${largeImageURL}\"><img src='${webformatURL}' alt='${tags}' loading=\"lazy\" ></a>\n                <div class=\"content\">\n                    <div class=\"item\"><h3>Likes</h3><p>${likes}</p></div>\n                    <div class=\"item\"><h3>Views</h3><p>${views}</p></div>\n                    <div class=\"item\"><h3>Comments</h3><p>${comments}</p></div>\n                    <div class=\"item\"><h3>Downloads</h3><p>${downloads}</p></div>\n                </div>\n            </li>`\n    )\n    .join('');\n}\n\nexport function addLoader() {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    `<div class='loader-wrapper'>\n        <div class='loader'></div>\n    </div>`\n  );\n}\n","import axios from 'axios';\nimport { MESSAGES, MESSAGES_BG_COLORS, showInfoMessage } from './helpers';\nimport { addLoader } from './render-functions';\n\nconst API_KEY = '44405804-89924783490777dc17a96fec8';\nconst API_URL = 'https://pixabay.com/api/?';\nconst CONFIG = {\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientations: 'horizontal',\n    safesearch: true,\n    page: 1,\n    per_page: 15,\n  },\n};\n\nexport async function getGalleryData(queryValue, page) {\n  addLoader();\n\n  try {\n    CONFIG.params.q = queryValue;\n    CONFIG.params.page = page;\n    const response = await axios.get(API_URL, CONFIG);\n    return response.data;\n  } catch (error) {\n    if (error.response) {\n      const { data } = error.response;\n      showInfoMessage(\n        `${MESSAGES.exception} ERROR: ${data}`,\n        MESSAGES_BG_COLORS.orange\n      );\n    } else if (error.request) {\n      showInfoMessage(\n        `${MESSAGES.exception} ERROR: ${error.request}`,\n        MESSAGES_BG_COLORS.orange\n      );\n    } else {\n      showInfoMessage(\n        `${MESSAGES.exception} ERROR: ${error.message}`,\n        MESSAGES_BG_COLORS.orange\n      );\n    }\n  }\n}\n","import iziToast from 'izitoast';\nimport {\n  EVENT_TYPE,\n  MESSAGES,\n  MESSAGES_BG_COLORS,\n  showInfoMessage,\n  refs,\n} from './js/helpers';\n\nimport { getGalleryData } from './js/pixabay-api';\nimport { fetchGallery } from './js/render-functions';\n\nconst { form, gallery, loadBtn } = refs;\n\nlet queryString = '';\nlet currentPage = 1;\nlet evtType = '';\n\nconst IMAGE_MAX_COUNT = 15;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  loadBtn.classList.remove('visible');\n\n  gallery.innerHTML = '';\n  currentPage = 1;\n\n  const search = e.target.search.value.trim();\n\n  evtType = EVENT_TYPE.submit;\n\n  iziToast.destroy();\n\n  queryString = search;\n\n  if (!search) {\n    showInfoMessage(MESSAGES.info, MESSAGES_BG_COLORS.blue);\n    return;\n  }\n  try {\n    await renderGallery(queryString, currentPage);\n  } catch (error) {\n    console.log('submit', error);\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n  e.target.reset();\n});\n\nloadBtn.addEventListener('click', async () => {\n  evtType = EVENT_TYPE.click;\n  loadBtn.classList.remove('visible');\n  try {\n    await renderGallery(queryString, currentPage);\n    const liEl = document.querySelector('li');\n    const { height } = liEl.getBoundingClientRect();\n    scrollVertical(height * 3, 0);\n  } catch (error) {\n    console.log('click', error);\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n});\n\nasync function renderGallery(searchValue, page) {\n  if (evtType === EVENT_TYPE.click) {\n    page += 1;\n    currentPage = page;\n  }\n  try {\n    const galleryData = await getGalleryData(searchValue, page);\n\n    if (validateGalleryData(galleryData)) {\n      const restOfImages = Math.round(galleryData.totalHits / page);\n      fetchGallery(galleryData);\n      showHideBtn(restOfImages);\n    }\n  } catch (error) {\n    console.log('renderGallery', error);\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n  removeLoader();\n}\n\nfunction scrollVertical(x = 0, y = 0) {\n  window.scrollBy({ top: x, left: y, behavior: 'smooth' });\n}\n\nfunction removeLoader() {\n  const loaderWrapper = document.querySelector('.loader-wrapper');\n  loaderWrapper.remove();\n}\n\nfunction validateGalleryData(galleryData) {\n  if (!galleryData) {\n    return false;\n  } else if (galleryData.totalHits === 0) {\n    showInfoMessage(MESSAGES.warning, MESSAGES_BG_COLORS.red);\n    return false;\n  } else {\n    return true;\n  }\n}\n\nfunction showHideBtn(imagesCount) {\n  if (imagesCount <= IMAGE_MAX_COUNT) {\n    loadBtn.classList.remove('visible');\n    showInfoMessage(MESSAGES.endOfSearch, MESSAGES_BG_COLORS.blue);\n    return;\n  }\n  loadBtn.classList.add('visible');\n}\n"],"names":["refs","MESSAGES","MESSAGES_BG_COLORS","EVENT_TYPE","showInfoMessage","message","color","iziToast","lightbox","SimpleLightbox","gallery","fetchGallery","data","markupGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","addLoader","API_KEY","API_URL","CONFIG","getGalleryData","queryValue","page","axios","error","form","loadBtn","queryString","currentPage","evtType","IMAGE_MAX_COUNT","search","renderGallery","liEl","height","scrollVertical","searchValue","galleryData","validateGalleryData","restOfImages","showHideBtn","removeLoader","x","y","imagesCount"],"mappings":"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"}